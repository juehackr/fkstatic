(function(){function a(a,b){var c,d;for(c in b)void 0!==(d=b[c])&&(a[c]=d);return a}var b=function(){},c=function(c,d){var e;return e=d&&d.hasOwnProperty("constructor")?d.constructor:function(){return c.apply(this,arguments)},b.prototype=c.prototype,e.prototype=new b,d&&a(e.prototype,d),e.prototype.constructor=e,e.__super__=c.prototype,e},d={version:"0.1.15"};d.Stack=function(){this.commands=[],this.stackPosition=-1,this.savePosition=-1},a(d.Stack.prototype,{execute:function(a){this._clearRedo(),a.execute(),this.commands.push(a),this.stackPosition++,this.changed()},undo:function(){this.commands[this.stackPosition].undo(),this.stackPosition--,this.changed()},canUndo:function(){return this.stackPosition>=0},redo:function(){this.stackPosition++,this.commands[this.stackPosition].redo(),this.changed()},canRedo:function(){return this.stackPosition<this.commands.length-1},save:function(){this.savePosition=this.stackPosition,this.changed()},dirty:function(){return this.stackPosition!=this.savePosition},_clearRedo:function(){this.commands=this.commands.slice(0,this.stackPosition+1)},changed:function(){}}),d.Command=function(a){this.name=a};var e=new Error("override me!");a(d.Command.prototype,{execute:function(){throw e},undo:function(){throw e},redo:function(){this.execute()}}),d.Command.extend=function(a){var b=c(this,a);return b.extend=d.Command.extend,b},"function"==typeof define&&define.amd?define(d):"undefined"!=typeof module&&module.exports?module.exports=d:this.Undo=d}).call(this);