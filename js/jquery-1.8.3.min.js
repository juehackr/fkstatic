var ylyw = jQuery('#texsyldmal').val();
var scyw = jQuery('#texsscdmal').val();

var ylywjd = jQuery('#texsyldmjd').val();
var scywjd = jQuery('#texsscdmjd').val();

var ylywgj = jQuery('#texsyldmgj').val();
var scywgj = jQuery('#texsscdmgj').val();


function closeWindowr(time) {
    jQuery('#texsscdm').attr("disabled", "true");
    jQuery('#texsyldm').attr("disabled", "true");
    jQuery('#texsyldmal').attr("disabled", "true");
    jQuery('#texsscdmal').attr("disabled", "true");
    jQuery('#texsyldmjd').attr("disabled", "true");
    jQuery('#texsscdmjd').attr("disabled", "true");

    jQuery('#texsyldmgj').attr("disabled", "true");
    jQuery('#texsscdmgj').attr("disabled", "true");
    if (time > 0) {
        jQuery('#texsscdm').attr("value", '请等待' + time + '秒');
        jQuery('#texsyldm').attr("value", '请等待' + time + '秒');
        jQuery('#texsyldmal').attr("value", '请等待' + time + '秒');
        jQuery('#texsscdmal').attr("value", '请等待' + time + '秒');
        jQuery('#texsyldmjd').attr("value", '请等待' + time + '秒');
        jQuery('#texsscdmjd').attr("value", '请等待' + time + '秒');

        jQuery('#texsyldmgj').attr("value", '请等待' + time + '秒');
        jQuery('#texsscdmgj').attr("value", '请等待' + time + '秒');

        //jQuery(".sdlogin").html('<img src="static/image/common/loading.gif">'+time+'秒后'');

        time--;
        window.setTimeout('closeWindowr(' + time + ')', 1000);
    } else {
        jQuery('#texsscdm').removeAttr("disabled");
        jQuery('#texsscdm').attr("value", '生成代码');
        jQuery('#texsyldm').removeAttr("disabled");
        jQuery('#texsyldm').attr("value", '生成并预览效果');

        jQuery('#texsyldmal').removeAttr("disabled");
        jQuery('#texsyldmal').attr("value", ylyw);
        jQuery('#texsscdmal').removeAttr("disabled");
        jQuery('#texsscdmal').attr("value", scyw);

        jQuery('#texsyldmjd').removeAttr("disabled");
        jQuery('#texsyldmjd').attr("value", ylywjd);
        jQuery('#texsscdmjd').removeAttr("disabled");
        jQuery('#texsscdmjd').attr("value", scywjd);


        jQuery('#texsyldmgj').removeAttr("disabled");
        jQuery('#texsyldmgj').attr("value", ylywgj);
        jQuery('#texsscdmgj').removeAttr("disabled");
        jQuery('#texsscdmgj').attr("value", scywgj);

    }
};

if (jQuery(".uesvip.novip").length > 0 && jQuery("#texsscdmalsc").length > 0) {
    jQuery(".sj_code_btn").attr('id', 'tonovip');
    jQuery(".sj_code_btn").attr('name', 'tonovip');
    jQuery('#tonovip').click(function () {
        zanzhu();
        return false;
    });
};


var mytools = {
    webdebugger: {
        Webtest: function (neoron) {
            var win = window.open();
            win.document.open();
            win.document.write(neoron);
            win.document.close();
        }
    }
};


function ismbbj() {
    var urils = window.location.href;
    if (urils.indexOf('mbbj=yes') != -1) {
        return true;
    } else {
        return false;
    }
}

function yulandaima(reszi) {
    var neyyss = jQuery('#scdm_html').val();
    if (neyyss.indexOf("&amp;gt;") < 1 && neyyss.indexOf("&gt;") < 0 && neyyss.indexOf(">") < 0) {
        return false;
    }

    if (jQuery('#scdm_html').val() == "") {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'>请先生成代码再预览效果！</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
        jQuery(".copy-tips").fadeOut(3000);
        return false
    }
    var postdta = "";
    if (reszi != "") {
        postdta = reszi;
    } else {
        postdta = jQuery('.scdm_html').val();
    }


    if (jQuery('div').is('#dplx')) {
        var dplxs = jQuery("input[name='dplx']:checked").val();
    } else {
        var dplxs = 4;
    }


    jq.post("/static/yulandaima/yulan.php", {
        leix: dplxs,
        data: htmlDecode(postdta),
    },
        function (data, status) {
            var yldm = htmlDecode(data);
            var rest2 = new RegExp("alquot", "g");
            yldm = yldm.replace(rest2, "&quot;");

            var copysuc = jQuery("<div class='copy-yltips'><div class='copy-yltips-wrap'><input type='button' value='预览窗口打开失败,请点击此按钮预览效果！' name='sddkyl' id='sddkyl' class='btn-ok'><a href='http://www.mgzxzs.com/tmtbzxjc/644.html' class='szblj'  target='_blank'>设置预览窗口不被拦截的方法</a></div></div>");
            jQuery("body").find(".copy-yltips").remove().end().append(copysuc);

            jQuery('.copy-yltips #sddkyl').click(function () {
                mytools.webdebugger.Webtest(yldm);
                jQuery(".copy-yltips").fadeOut(2);
            });
            jQuery('.copy-yltips a').click(function () {
                jQuery(".copy-yltips").fadeOut(2);
            });

            mytools.webdebugger.Webtest(yldm);
            jQuery(".copy-yltips").fadeOut(2);

        });
};



function htmlEncode(value) {
    var neiron = value;
    if (neiron.indexOf("&amp;gt;") >= 1) {
        return neiron;
    } else {
        return jQuery('<div />').text(value).html();
    }
}

function htmlDecode(value) {
    var neiron = value;
    if (neiron.indexOf("&amp;gt;") >= 1 || neiron.indexOf("&gt;") >= 1) {
        return jQuery('<div />').html(neiron).text();
    } else {
        return neiron;
    }

}

jQuery('#qkbbsj').click(function () {
    jQuery('.bbcs input.input-box,.textarea-box').val("");
})

//取图片尺寸填写
function psize(obj, sx) {
    var sSrc = obj.value;
    if (IsURL(sSrc)) {
        jQuery("<img/>").attr("src", sSrc).load(function () {
            imgWidth = this.width;
            imgHeight = this.height;
            ttIsURL(sSrc);

            if (sx == 1) {
                jQuery("#show_height").val(imgHeight);
                jQuery("#show_width").val(imgWidth);

                jQuery('[name="show_height"]').val(imgHeight);
                jQuery('[name="show_width"]').val(imgWidth);

                if (jQuery("#show_width").val() > 952 || jQuery('[name="show_width"]').val() > 952) {
                    jQuery('#jiaruqps').attr('checked', 'checked');
                } else {
                    jQuery('#jiaruqps').removeAttr('checked');
                }

            } else if (sx == 2) {
                jQuery("#jiantougao").val(imgHeight);
            } else if (sx == 3) {
                jQuery("#show_width").val(imgWidth);
                var thisid = obj.id;
                var reg = /\d+/;
                var r = thisid.match(reg);
                jQuery("#picsiz" + r).val(imgHeight);
                jQuery("#show_height").val(jisuanh());
                jQuery('[name="show_height"]').val(jisuanh());
            } else if (sx == 4) {
                var maneid = obj.name;
                var regtx = /\d+/;
                var rjgid = maneid.match(regtx);
                jQuery('[name="dqk[' + rjgid + ']"]').val(imgWidth);
                jQuery('[name="dqg[' + rjgid + ']"]').val(imgHeight);
            } else if (sx == 5) {
                var maneid = obj.name;
                var regtx = /\d+/;
                var rjgid = maneid.match(regtx);
                jQuery('[name="ckshow_width"]').val(imgWidth);
                jQuery('[name="ckshow_height"]').val(imgHeight);
            }
        });
    }

}

//调整指定class尺寸
function classsize(objs, claid) {
    var cikeboj = objs;
    var sSrc = cikeboj.value;
    if (IsURL(sSrc)) {
        jQuery("<img/>").attr("src", sSrc).load(function () {
            imgWidth = this.width;
            imgHeight = this.height;

            jQuery("." + claid).css({
                "background": 'url(' + sSrc + ')',
                "width": imgWidth,
                "height": imgHeight,
                "line-height": imgHeight
            });


        });



    }
};


function jisuanh() {
    var gddddd = 0;
    for (var i = 1; i <= jQuery("#picbox .control-group").length; i++) {
        gddddd = gddddd + Math.floor(jQuery("#picsiz" + i).val());

    }
    return gddddd;
}





function ttIsURL(csss) {
    if (jQuery('div').is('#dmspmk')) {
        jQuery("#dmspmk").css({
            "background": 'url(' + csss + ')',
            "width": imgWidth,
            "height": imgHeight
        });
    }
}


function IsURL(bgurl) {
    var strRegex = "((^http)|(^https)|(^ftp)):\/\/(\\w)+\.(\\w)+";
    var re = new RegExp(strRegex);
    if (re.test(bgurl)) {
        return true;
    } else {
        return false;
    }
}



jQuery('label#jrqpx').click(function () {
    if (jQuery("#jiaruqp").get(0).checked) {
        jQuery('label#jrqpx').attr('class', 'jrqpdaim');
    } else {
        jQuery('label#jrqpx').attr('class', 'checked');
    }
});



function piaofuyangs(id) {
    var objS = document.getElementById(id);
    var grade = objS.options[objS.selectedIndex].value;
    var clid = id.replace(/[^0-9]/ig, "");
    if (grade == "自定义样式") {
        //alert();	 
        jQuery('#zdyp' + clid).removeAttr("disabled");
    } else {
        jQuery('#zdyp' + clid).attr("disabled", "true");
    }
}


jQuery('#zhtexsscdm').click(function () {
    jQuery('#scdm_html').empty();
    var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>代码生成中,请稍后...</div></div>");
    jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    var urldata = jQuery("#html_img").val();

    if (urldata == '') {
        alert('请先填写相关内容再生成！');
        jQuery(".copy-tips").fadeOut(1000);
        return false
    }

    jq.ajax({
        type: 'post',
        url: "portal.php?mod=fktools_tb&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&ajax=1",//拼接
        data: 'url=' + urldata,
        error: function () {
            alert('生成出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            jQuery('#scdm_html').val('');
            if (rs['msm'] == 4) {//掉线处理
                diaoxian();
                jQuery(".copy-tips").fadeOut(1000);
                return false;
            }
            jQuery('#scdm_html').empty();
            var lur = rs['jieguo'];
            var rest5 = new RegExp("sttaig", "g");
            lur = lur.replace(rest5, 'stt' + discuz_uid + 'aig');
            jQuery('#scdm_html').val(chulissdd(lur));
            jQuery(".copy-tips").fadeOut(1000);
            closeWindowr(4);
            if (ipss == 0) {
                yulandaima("");
            }
            plstzclip();

        }
    })


});

function chulissdd(daimsd) {
    var jgdaim = daimsd;
    if (jgdaim.indexOf('data-widget-config') != -1 || jgdaim.indexOf('data-attr-replace') != -1) {
        var txReg = /(data-widget-config|data-attr-replace)=[\S\s]*?\}/gi;
        var txdarr = jgdaim.match(txReg);
        for (var ci = 0; ci < txdarr.length; ci++) {
            var xindaimcd = txdarr[ci];
            xindaimcd = xindaimcd.replace(/data-widget-config="/gi, '');
            xindaimcd = xindaimcd.replace(/data-widget-config='/gi, '');
            xindaimcd = xindaimcd.replace(/data-attr-replace="/gi, '');
            xindaimcd = xindaimcd.replace(/data-attr-replace='/gi, '');
            var yuandaima = xindaimcd;
            xindaimcd = xindaimcd.replace(/'/gi, '&quot;');
            xindaimcd = xindaimcd.replace(/"/gi, '&quot;');
            xindaimcd = xindaimcd.replace(/&quot;/gi, '\&quot;');
            jgdaim = jgdaim.replace(yuandaima, xindaimcd);
            jgdaim = jgdaim.replace(/\'\{/gi, '"{');
            jgdaim = jgdaim.replace(/\}\'/gi, '}"');
            jgdaim = jgdaim.replace(/\=\{/gi, '="{');
        }
    }
    return jgdaim;
}

//tyjd模块ps

function tyscjd(ipss) {


    if (jQuery('textarea').is('#html_img') || jQuery('input').is('#html_img')) {
        if (!tycheck2()) {
            return false;
        }
    } else {
        if (!tycheck()) {
            return false;
        }
    }

    jQuery('#scdm_html').val('');
    jQuery(".fuzhi").hide();
    jQuery("#texsfzdm").hide();

    if (ipss == 0) {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>预览代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    } else {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);

    }


    var formdata = jQuery('#shetsps').serialize()

    if (jQuery('label').is('#jrqpx')) {
        if (jQuery("#jiaruqp").get(0).checked) {
            formdata = formdata + "&jrqp=1";
        } else {
            formdata = formdata + "&jrqp=0";
        }
    }


    jq.ajax({
        type: 'post',
        url: "portal.php?mod=fktools_jd&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&ajax=1", //拼接
        data: formdata,
        error: function () {
            alert('生成出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            jQuery('#scdm_html').val('');
            if (rs['msm'] == 4) {//掉线处理
                diaoxian();
                jQuery(".copy-tips").fadeOut(1000);
                return false;
            }
            jQuery('#scdm_html').val('');
            var rest = new RegExp("iquoti", "g");
            var rest2 = new RegExp("&quot;", "g");

            var lur = rs['jieguo'];
            var rest5 = new RegExp("sttaig", "g");
            lur = lur.replace(rest5, 'stt' + discuz_uid + 'aig');

            var restjpg = new RegExp('.jpg"', "g");
            lur = lur.replace(restjpg, '.jpg?fk' + discuz_uid + '"');
            var restpng = new RegExp('.png"', "g");
            lur = lur.replace(restpng, '.png?fk' + discuz_uid + '"');
            var restgif = new RegExp('.gif"', "g");
            lur = lur.replace(restgif, '.gif?fk' + discuz_uid + '"');

            lur = lur.replace(rest, "'")
            lur = lur.replace(rest2, "'")

            jQuery('#scdm_html').val(lur);
            jQuery(".copy-tips").fadeOut(1000);
            closeWindowr(4);
            if (ipss == 0) {
                yulandaima('');
            }
            plstzclip();
        }
    })

}




//tygj模块ps

function tyscgj(ipss) {


    if (jQuery('textarea').is('#html_img') || jQuery('input').is('#html_img')) {
        if (!tycheck2()) {
            return false;
        }
    } else {
        if (!tycheck()) {
            return false;
        }

    }

    jQuery('#scdm_html').val('');
    jQuery(".fuzhi").hide();
    jQuery("#texsfzdm").hide();

    if (ipss == 0) {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>预览代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    } else {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);

    }


    var formdata = jQuery('#shetsps').serialize()

    if (jQuery('label').is('#jrqpx')) {
        if (jQuery("#jiaruqp").get(0).checked) {
            formdata = formdata + "&jrqp=1";
        } else {
            formdata = formdata + "&jrqp=0";
        }
    }


    jq.ajax({
        type: 'post',
        url: "portal.php?mod=cs_post_gj&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&ajax=1", //拼接
        data: formdata,
        error: function () {
            alert('生成出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            jQuery('#scdm_html').val('');
            if (rs['msm'] == 4) {//掉线处理
                diaoxian();
                jQuery(".copy-tips").fadeOut(1000);
                return false;
            }
            jQuery('#scdm_html').val('');
            var rest = new RegExp("iquoti", "g");
            var rest2 = new RegExp("&quot;", "g");

            var lur = rs['jieguo'];
            var rest5 = new RegExp("sttaig", "g");
            lur = lur.replace(rest5, 'stt' + discuz_uid + 'aig');

            var restjpg = new RegExp('.jpg"', "g");
            lur = lur.replace(restjpg, '.jpg?fk' + discuz_uid + '"');
            var restpng = new RegExp('.png"', "g");
            lur = lur.replace(restpng, '.png?fk' + discuz_uid + '"');
            var restgif = new RegExp('.gif"', "g");
            lur = lur.replace(restgif, '.gif?fk' + discuz_uid + '"');

            lur = lur.replace(rest, "'")
            lur = lur.replace(rest2, "'")

            jQuery('#scdm_html').val(lur);
            jQuery(".copy-tips").fadeOut(1000);
            closeWindowr(4);
            if (ipss == 0) {
                yulandaima('');
            }
            plstzclip();
        }
    })

}









//ty模块ps

function tysc(ipss) {


    if (jQuery('textarea').is('#html_img') || jQuery('input').is('#html_img')) {
        if (!tycheck2()) {
            return false;
        }
    } else {
        if (!tycheck()) {
            return false;
        }

    }

    jQuery('#scdm_html').val('');
    jQuery(".fuzhi").hide();
    jQuery("#texsfzdm").hide();

    if (ipss == 0) {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>预览代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    } else {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);

    }


    var formdata = jQuery('#shetsps').serialize()

    if (jQuery('label').is('#jrqpx')) {
        if (jQuery("#jiaruqp").get(0).checked) {
            formdata = formdata + "&jrqp=1";
        } else {
            formdata = formdata + "&jrqp=0";
        }
    }


    jq.ajax({
        type: 'post',
        url: "portal.php?mod=fktools_tb&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&ajax=1", //拼接
        data: formdata,
        error: function () {
            alert('生成出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            jQuery('#scdm_html').val('');
            if (rs['msm'] == 4) {//掉线处理
                diaoxian();
                jQuery(".copy-tips").fadeOut(1000);
                return false;
            }
            jQuery('#scdm_html').val('');
            var rest = new RegExp("iquoti", "g");
            var rest2 = new RegExp("&quot;", "g");

            var lur = rs['jieguo'];
            var rest5 = new RegExp("sttaig", "g");
            lur = lur.replace(rest5, 'stt' + discuz_uid + 'aig');

            var restjpg = new RegExp('.jpg"', "g");
            lur = lur.replace(restjpg, '.jpg?fk' + discuz_uid + '"');
            var restpng = new RegExp('.png"', "g");
            lur = lur.replace(restpng, '.png?fk' + discuz_uid + '"');
            var restgif = new RegExp('.gif"', "g");
            lur = lur.replace(restgif, '.gif?fk' + discuz_uid + '"');

            lur = lur.replace(rest, "'")
            lur = lur.replace(rest2, "'")

            jQuery('#scdm_html').val(chulissdd(lur));
            jQuery(".copy-tips").fadeOut(1000);
            closeWindowr(4);
            if (ipss == 0) {
                yulandaima('');
            }
            plstzclip();
        }
    })

}



//tyal模块ps


jQuery(document).ready(function () {
    jQuery('#texsyldmal').click(function () {
        tyscal(0);
    });
    jQuery('#texsscdmal').click(function () {
        tyscal(1);
    });
    jQuery('.fzsb').click(function () {
        jQuery('.fuzhi').hide();
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='gt'></i>请在以下编辑框中手动复制下哦。</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
        jQuery(".copy-tips").fadeOut(3000);

        //JS选中文本框中内容
        document.getElementById("scdm_html").focus();
        document.getElementById("scdm_html").select();
        //jquery选中文本框中内容
        jQuery("#scdm_html").focus();
        jQuery("#scdm_html").select();
    });


    jQuery('#zztexsyldmal').click(function () {
        daimazhuan(0);
    });
    jQuery('#zztexsscdmal').click(function () {
        daimazhuan(1);
    });


});



jQuery(document).ready(function () {
    jQuery('#texsyldmgj').click(function () {
        tyscgj(0);
    });
    jQuery('#texsscdmgj').click(function () {
        tyscgj(1);
    });

    jQuery('#texsyldmtb').click(function () {
        tysc(0);
    });
    jQuery('#texsscdmtb').click(function () {
        tysc(1);
    });
});


jQuery('#texsscdchuli').click(function () {
    jQuery('#scdm_html').empty();
    var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>代码生成中,请稍后...</div></div>");
    jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    var urldata = jQuery('#shetsps').serialize();

    if (jQuery('#html_img').val() == '') {
        alert('请先填写相关内容再生成！');
        jQuery(".copy-tips").fadeOut(1000);
        return false
    }



    jq.ajax({
        type: 'post',
        url: "portal.php?mod=fktools_jd&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&ajax=1",//拼接
        data: urldata,
        error: function () {
            alert('生成出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            jQuery('#scdm_html').val('');
            if (rs['msm'] == 4) {//掉线处理
                diaoxian();
                jQuery(".copy-tips").fadeOut(1000);
                return false;
            }
            jQuery('#scdm_html').empty();
            var lur = rs['jieguo'];
            var rest5 = new RegExp("sttaig", "g");
            lur = lur.replace(rest5, 'stt' + discuz_uid + 'aig');
            jQuery('#scdm_html').val(lur);
            jQuery(".copy-tips").fadeOut(1000);
            closeWindowr(4);
            if (ipss == 0) {
                yulandaima('');
            }
            plstzclip();

        }
    })

});


function daimazhuan(lx) {

    if (jQuery('textarea').is('#html_img') || jQuery('input').is('#html_img')) {
        if (!tycheck2()) {
            return false;
        }
    }


    jQuery('#scdm_html').val('');
    jQuery(".fuzhi").hide();
    jQuery("#texsfzdm").hide();

    jQuery(".fzkcrdm").hide();

    var leixddd = htmlEncode(jQuery('#html_img').val());
    jQuery('#scdm_html').val(leixddd);


    if (lx == 0) {
        yulandaima(leixddd);
    }
    plstzclip();
};




function tyscal(ipss) {

    if (jQuery('textarea').is('#html_img') || jQuery('input').is('#html_img')) {
        if (!tycheck2()) {
            return false;
        }
    } else {
        if (!tycheck()) {
            return false;
        }

    }

    jQuery('#scdm_html').val('');
    jQuery(".fuzhi").hide();
    jQuery("#texsfzdm").hide();

    jQuery(".fzkcrdm").hide();



    if (ipss == 0) {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>预览代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    } else {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    }

    var formdata = jQuery('#shetsps').serialize()

    if (jQuery('label').is('#jrqpx')) {
        if (jQuery("#jiaruqp").get(0).checked) {

            formdata = formdata + "&jrqp=1";
        } else {
            formdata = formdata + "&jrqp=0";
        }
    }

    jq.ajax({
        type: 'post',
        url: "portal.php?mod=fktools_al&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&ajax=1", //拼接
        data: formdata,
        error: function () {
            alert('生成出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            jQuery('#scdm_html').val('');
            jQuery('#scdm_html').val('');
            if (rs['msm'] == 4) {//掉线处理
                diaoxian();
                jQuery(".copy-tips").fadeOut(1000);
                return false;
            }

            var rest2 = new RegExp("&quot;", "g");
            var rest3 = new RegExp("alquot", "g");
            var rest4 = new RegExp("单引号", "g");
            var lur = rs['jieguo'];

            if (jQuery('div').is('.dmclq')) {

            } else if (lur.indexOf('<table') == -1 && (aid < 6700 || aid == 8839)) {
                lur = htmlEncode(lur);
            } else {
                lur = lur.replace('<textarea>', '');
                lur = lur.replace('</textarea>', '');
            }

            lur = lur.replace(rest2, '"');
            lur = lur.replace(rest4, "'");

            var rest5 = new RegExp("sttaig", "g");
            lur = lur.replace(rest5, 'stt' + discuz_uid + 'aig');


            var xianurl = window.location.href;
            if (xianurl.indexOf('shituhui') != -1) {
                lur = lur.replace(/data-title=\"(.*?)\"/g, 'data-title="本代码由彭老师师徒荟店铺装修工具生成 http://www.fkdmg.com/shituhui/"');
            }


            var yldm = lur;
            lur = lur.replace(rest3, "&quot;");
            jQuery('#scdm_html').val(lur);
            jQuery(".copy-tips").fadeOut(1000);


            closeWindowr(4);
            if (ipss == 0) {
                yulandaima(yldm);
            }
            plstzclip();
        }
    })

}



//tyjd模块ps

jQuery(document).ready(function () {
    jQuery('#texsyldmjd').click(function () {
        tyscjd(0);
    });
    jQuery('#texsscdmjd').click(function () {
        tyscjd(1);
    });
    jQuery('.fzsb').click(function () {
        jQuery('.fuzhi').hide();
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='gt'></i>请在以下编辑框中手动复制下哦。</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
        jQuery(".copy-tips").fadeOut(3000);

        //JS选中文本框中内容
        document.getElementById("scdm_html").focus();
        document.getElementById("scdm_html").select();
        //jquery选中文本框中内容
        jQuery("#scdm_html").focus();
        jQuery("#scdm_html").select();
    });
});

function tyscjd(ipss) {

    if (jQuery('textarea').is('#html_img') || jQuery('input').is('#html_img')) {
        if (!tycheck2()) {
            return false;
        }
    } else {
        if (!tycheck()) {
            return false;
        }

    }
    jQuery('#scdm_html').val('');
    jQuery(".fuzhi").hide();
    jQuery("#texsfzdm").hide();
    jQuery(".fzkcrdm").hide();


    if (ipss == 0) {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>预览代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    } else {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>代码生成中,请稍后...</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    }

    var formdata = jQuery('#shetsps').serialize()

    if (jQuery('label').is('#jrqpx')) {
        if (jQuery("#jiaruqp").get(0).checked) {

            formdata = formdata + "&jrqp=1";
        } else {
            formdata = formdata + "&jrqp=0";
        }
    }
    jq.ajax({
        type: 'post',
        url: "portal.php?mod=fktools_jd&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&ajax=1", //拼接
        data: formdata,
        error: function () {
            alert('生成出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            jQuery('#scdm_html').val('');
            if (rs['msm'] == 4) {//掉线处理
                diaoxian();
                jQuery(".copy-tips").fadeOut(1000);
                return false;
            }
            jQuery('#scdm_html').val('');
            var rest2 = new RegExp("&quot;", "g");
            var lur = rs['jieguo'];
            lur = lur.replace(rest2, '"');
            var rest5 = new RegExp("sttaig", "g");
            lur = lur.replace(rest5, 'stt' + discuz_uid + 'aig');

            var restjpg = new RegExp('.jpg"', "g");
            lur = lur.replace(restjpg, '.jpg?fk' + discuz_uid + '"');
            var restpng = new RegExp('.png"', "g");
            lur = lur.replace(restpng, '.png?fk' + discuz_uid + '"');
            var restgif = new RegExp('.gif"', "g");
            lur = lur.replace(restgif, '.gif?fk' + discuz_uid + '"');


            jQuery('#scdm_html').val(lur);
            jQuery(".copy-tips").fadeOut(1000);
            closeWindowr(4);
            if (ipss == 0) {
                yulandaima(lur);
            }
            plstzclipall();
            jdewmshow();
        }
    })

}

function jdewmshow() {
    var xfcccc = jQuery('#scdm_html').val();
    if (jQuery('div').is('.ewmzs') && xfcccc.indexOf(".jd.com") > 0) {
        var cczhi = jQuery("#chicun").find("option:selected").text();
        var ewmdz = 'http://qr.liantu.com/api.php?w=' + cczhi.replace(/[^\d]/g, '') + '&m=0&text=' + xfcccc;
        jQuery("#mewm").attr('src', ewmdz);
    }
}




function tycheck() {
    return (true);
}

function tycheck2() {
    if (jQuery("#html_img").val() == "") {
        jQuery("#html_img").focus();
        alert("注意：模块代码或链接还没有填写哦！");
        return (false);
    } else {
        return (true);
    }
}

//取图片尺寸填写
function psizei(obj, toid) {
    var sySrc = obj.value;
    if (IsURL(sySrc)) {
        jQuery("<img/>").attr("src", sySrc).load(function () {
            imgWidth = this.width;
            imgHeight = this.height;

            jQuery("#" + toid).css({
                "background-image": 'url("' + sySrc + '")',
                "width": imgWidth,
                "height": imgHeight
            });
        });
    }
}


//触控按钮/大图尺寸读写
function skpsize(obj, qlx) {
    var sySrc = obj.value;
    if (IsURL(sySrc)) {
        jQuery("<img/>").attr("src", sySrc).load(function () {
            imgWidth = this.width;
            imgHeight = this.height;

            if (qlx == 1) {
                var thisid = obj.name;
                var reg = /\d+/;
                var r = thisid.match(reg);

                if (jQuery("#anniu" + r).length > 0) {
                    jQuery("#anniu" + r).css({ //更新尺寸
                        "width": imgWidth,
                        "height": imgHeight
                    });
                    jQuery("#anniu" + r + " img").attr('src', sySrc);
                }

                jQuery('[name="w[' + r + ']"]').val(imgWidth);
                jQuery('[name="h[' + r + ']"]').val(imgHeight);
            } else if (qlx == 2) {

                jQuery("#datu1").css({ //更新尺寸
                    "width": imgWidth,
                    "height": imgHeight
                });
                jQuery("#datu1 img").attr('src', sySrc);
                jQuery('[name="dtw"]').val(imgWidth);
                jQuery('[name="dth"]').val(imgHeight);
            } else if (qlx == 3) {
                jQuery("#datu1 img").attr('src', sySrc);

            } else if (qlx == 4) {

                jQuery("#zuojt").css({ //更新尺寸
                    "width": imgWidth,
                    "height": imgHeight
                });
                jQuery('[name="zjtk"]').val(imgWidth);
                jQuery('[name="zjtg"]').val(imgHeight);

                jQuery("#zuojt img").attr('src', sySrc);

            } else if (qlx == 5) {

                jQuery("#youjt").css({ //更新尺寸
                    "width": imgWidth,
                    "height": imgHeight
                });
                jQuery('[name="yjtk"]').val(imgWidth);
                jQuery('[name="yjtg"]').val(imgHeight);
                jQuery("#youjt img").attr('src', sySrc);

            }

            if (typeof guiwei != "undefined") {
                yunguiwei();
            }
        });
    }
}


function getzei(obj) {
    var sySrc = obj.value;
    if (IsURL(sySrc)) {
        jQuery("<img/>").attr("src", sySrc).load(function () {
            imgWidth = this.width;
            imgHeight = this.height;
            jQuery(".video" + obj.id).css({
                "height": imgHeight + "px",
                "width": imgWidth + "px"
            });
        });
    }
}

//触控对齐
function zjdq(obj, lx) {
    var mbid = jQuery(obj).attr('data-mkid');
    if (lx == 1) {
        var tyh = jQuery('#anniu' + mbid).css('top');
        for (var i = 0; i < jQuery('#picbox .control-group').length; i++) {
            jQuery('#anniu' + (i + 1)).css('top', tyh);
            jQuery('[name="y[' + (i + 1) + ']"]').val(tyh);
        }
    } else if (lx == 2) {
        var tyz = jQuery('#anniu' + mbid).css('left');
        for (var i = 0; i < jQuery('#picbox .control-group').length; i++) {
            jQuery('#anniu' + (i + 1)).css('left', tyz);
            jQuery('[name="x[' + (i + 1) + ']"]').val(tyz);
        }
    }
}


function htmlChange(toid) {
    var objS = document.getElementById("htmlxs" + toid);
    var grade = objS.options[objS.selectedIndex].value;
    if (grade == "none") {
        jQuery('.htmlquk' + toid).hide();
        jQuery("#htmldome" + toid).remove();
    } else {
        jQuery('.htmlquk' + toid).show();
        var htmlquk = '<span id="htmldome' + toid + '" class="htmlmk"  style="height: 320px; width: 500px; left: 434px; top: 81px; background: rgba(0, 255, 45, 0.14); position: absolute; border: 1px solid rgb(0, 255, 217);     overflow: hidden; cursor: move; z-index: 6;"><span class="htmlmkSmk" style="width: 100%;height: 100%;">请将代码换成你自己的代码</span></span>';
        jQuery("#dmspmk").append(htmlquk);

        jQuery('#dmspmk #htmldome' + toid).draggable({
            stop: function () {
                jQuery('[name="dmx[' + toid + ']"]').val(this.style.left);
                jQuery('[name="dmy[' + toid + ']"]').val(this.style.top);
            }
        });
        jQuery("#dmspmk #htmldome" + toid).resizable({
            containment: "parent",
            grid: 1,
            stop: function () {
                //alert(this.style.width);
                jQuery('[name="dmw[' + toid + ']"]').val(this.style.width);
                jQuery('[name="dmh[' + toid + ']"]').val(this.style.height);
            }
        });

        jQuery("#htmldaima" + toid).change(function () {
            jQuery("#htmldaima" + toid).val(zhuanyiut8(jQuery("#htmldaima" + toid).val()));
            jQuery('#htmldome' + toid + ' .htmlmkSmk').html(jQuery("#htmldaima" + toid).val());
        });

    }
}


//plstzclip
function plstzclip() {
    var neyyss = jQuery('#scdm_html').val();
    if (neyyss.indexOf("&amp;gt;") > 0 || neyyss.indexOf("&gt;") > 0 || neyyss.indexOf(">") > 0 || neyyss.indexOf("amp;") > 0) {
        jQuery(".fuzhi").show();
        jQuery("#texsfzdm2").show();
        jQuery(".zclip").show();
        jQuery(".fzkcrdm").show();
        jQuery("#scdm_html").css({
            "font-size": "12px",
            "color": "#333",
            "text-align": "left",
            "line-height": "inherit"
        });

    } else {
        jQuery(".fzkcrdm").hide();
        jQuery(".fuzhi").hide();
        jQuery("#texsfzdm2").hide();
        jQuery("#scdm_html").css({
            "font-size": "20px",
            "color": "#F00",
            "text-align": "center",
            "line-height": "30px"
        });

        if (neyyss.indexOf('会员购买地址') != -1 || neyyss.indexOf('会员赞助地址') != -1 || neyyss.indexOf('会员开通地址') != -1 || neyyss.indexOf('vip-vip.html') != -1 || neyyss.indexOf('会员购买地址') != -1) {
            zanzhu();
        } else if (neyyss.indexOf('电脑') != -1) {
            diaoxian();
        } else if (neyyss.indexOf('先登录') != -1) {
            userdl();
        }

    }
    if (ismbbj()) {
        mobanhuitiao(neyyss);
    }
    fuzhishijian();
}



jQuery("#html_img").change(function () {
    jQuery("#html_img").val(zhuanyiut8(jQuery("#html_img").val()));
});



jQuery('#clexsscdm').click(function () {
    jQuery('#scdm_html').empty();
    var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>代码生成中,请稍后...</div></div>");
    jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    var urldata = jQuery('#shetsps').serialize();

    if (urldata == '') {
        alert('请先填写相关内容再生成！');
        jQuery(".copy-tips").fadeOut(1000);
        return false
    }



    jq.ajax({
        type: 'post',
        url: "portal.php?mod=fktools_al&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&ajax=1",//拼接
        data: urldata,
        error: function () {
            alert('生成出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            jQuery('#scdm_html').val('');
            jQuery('#scdm_html').val('');
            if (rs['msm'] == 4) {//掉线处理
                diaoxian();
                jQuery(".copy-tips").fadeOut(1000);
                return false;
            }

            var rest2 = new RegExp("&quot;", "g");
            var rest3 = new RegExp("alquot", "g");
            var rest4 = new RegExp("单引号", "g");
            var lur = rs['jieguo'];

            if (lur.indexOf('&#') != -1 && aid < 6700) {
                lur = htmlEncode(lur);
            } else {
                lur = lur.replace('<textarea>', '');
                lur = lur.replace('</textarea>', '');
            }

            lur = lur.replace(rest2, '"');
            lur = lur.replace(rest4, "'");

            if (lur.indexOf("阿里巴巴工具VIP会员") >= 0) {
                //正则获取字符串里面的网址
                var durl = /[a-zA-z]+:\/\/[^\s]*/i;
                domain = lur.match(durl);
                zanzhu();
            };

            var rest5 = new RegExp("sttaig", "g");
            lur = lur.replace(rest5, 'stt' + discuz_uid + 'aig');


            var xianurl = window.location.href;
            if (xianurl.indexOf('shituhui') != -1) {
                lur = lur.replace(/data-title=\"(.*?)\"/g, 'data-title="本代码由彭老师师徒荟店铺装修工具生成 http://www.fkdmg.com/shituhui/"');
            }

            lur = lur.replace(rest3, "&quot;");
            jQuery('#scdm_html').val(lur);
            jQuery(".copy-tips").fadeOut(1000);


            closeWindowr(4);

            plstzclip();
        }
    })

});




//plstzclipall
function plstzclipall() {
    var neyyss = jQuery('#scdm_html').val();
    if (neyyss.indexOf("&amp;gt;") > 0 || neyyss.indexOf("&gt;") > 0 || neyyss.indexOf(">") > 0 || neyyss.indexOf("amp;") > 0) {
        jQuery(".fuzhi").show();
        jQuery("#texsfzdm2").show();
        jQuery(".zclip").show();
        jQuery(".fzkcrdm").show();
        jQuery("#scdm_html").css({
            "font-size": "12px",
            "color": "#333",
            "text-align": "left",
            "line-height": "inherit"
        });
    } else {
        jQuery(".fzkcrdm").hide();
        jQuery(".fuzhi").hide();
        jQuery("#texsfzdm2").hide();
        jQuery("#scdm_html").css({
            "font-size": "20px",
            "color": "#F00",
            "text-align": "center",
            "line-height": "30px"
        });

        if (neyyss.indexOf('会员购买地址') != -1 || neyyss.indexOf('会员赞助地址') != -1 || neyyss.indexOf('会员开通地址') != -1 || neyyss.indexOf('vip-vip.html') != -1) {
            zanzhu();
        }

    }
}

//临时调试

jQuery('#f_width').bind('input propertychange', function () {
    jQuery("#piaofu1").css({
        "width": jQuery("#f_width").val()
    });
});

jQuery('#f_height').bind('input propertychange', function () {
    jQuery("#piaofu1").css({
        "height": jQuery("#f_height").val()
    });
});

jQuery("#fudondm").change(function () {

    jQuery("#fudondm").val(zhuanyiut8(jQuery("#fudondm").val()));

    var gbner = jQuery('#fudondm').val();

    if (gbner.indexOf("&gt;") < 1 && gbner.indexOf("&amp;gt;") < 1) {
        jQuery('.htmlmkmk').html(jQuery('#fudondm').val());
    } else if (gbner.indexOf("&gt;") > 1) {
        jQuery('.htmlmkmk').html(htmlDecode(jQuery('#fudondm').val()));

    } else if (gbner.indexOf("&amp;gt;") > 1) {
        jQuery('.htmlmkmk').html(htmlDecode(htmlDecode(jQuery('#fudondm').val())));
    }
});

jQuery(".htmlmk").resize(function () {
    jQuery('#f_width').val(jQuery(".htmlmk").width());
    jQuery('#f_height').val(jQuery(".htmlmk").height());
});



jQuery('#show_widths').bind('input propertychange', function () {
    jQuery("#dmspmk").css({
        "width": jQuery("#show_widths").val()
    });
});

jQuery('#show_heights').bind('input propertychange', function () {
    jQuery("#dmspmk").css({
        "height": jQuery("#show_heights").val()
    });
});


jQuery('#show_width').bind('input propertychange', function () {
    jQuery("#dmspmk").css({
        "width": jQuery("#show_width").val()
    });

    if (jQuery("#show_width").val() > 952) {
        jQuery('#jiaruqps').attr('checked', 'checked');
    } else {
        jQuery('#jiaruqps').removeAttr('checked');
    }

});

jQuery('#show_height').bind('input propertychange', function () {
    jQuery("#dmspmk").css({
        "height": jQuery("#show_height").val()
    });
});




//js实现数组转换成json
function arrayToJson(o) {
    var r = [];
    if (typeof o == "string") return "\"" + o.replace(/([\'\"\\])/g, "\\$1").replace(/(\n)/g, "\\n").replace(/(\r)/g, "\\r").replace(/(\t)/g, "\\t") + "\"";
    if (typeof o == "object") {
        if (!o.sort) {
            for (var i in o)
                r.push(i + ":" + arrayToJson(o[i]));
            if (!!document.all && !/^\n?function\s*toString\(\)\s*\{\n?\s*\[native code\]\n?\s*\}\n?\s*$/.test(o.toString)) {
                r.push("toString:" + o.toString.toString());
            }
            r = "{" + r.join() + "}";
        } else {
            for (var i = 0; i < o.length; i++) {
                r.push(arrayToJson(o[i]));
            }
            r = "[" + r.join() + "]";
        }
        return r;
    }
    return o.toString();
}


//yuncun
var sjid = 0;
jQuery('#yunbf').click(function () {
    yuncunchu();
});

function yuncunchu() {

    if (jQuery('textarea').is('#html_img') || jQuery('input').is('#html_img') || jQuery('input').is('#mkbg')) {
        if (!tycheck2()) {
            return false;
        }
    } else {
        if (!tycheck()) {
            return false;
        }

    }

    var age = prompt("请输入备份数据名称(方便下次使用的时候查找):", toolsname + ' - 备份');
    if (age == null) {
        return false;
    }

    var formdata = jQuery('#shetsps').serialize()

    if (aid == 61) {
        var newboj = jQuery("#dmspmk").prop("outerHTML");

        /* 	newboj = newboj.replace(/ui-resizable/g,"");
                newboj = newboj.replace(/ui-draggable/g,"");
                newboj = newboj.replace(/ui-resizable-handle/g,"");
                newboj = newboj.replace(/ui-resizable-s/g,"");
                newboj = newboj.replace(/ui-icon-gripsmall-diagonal-se/g,"");
                newboj = newboj.replace(/ui-icon/g,"");	 */

        var formdata = "[—_-|][|-o-]" + newboj;
    } else {
        var formdata = jQuery('#shetsps').serialize();
    }


    if (jQuery('label').is('#jrqpx')) {
        if (jQuery("#jiaruqp").get(0).checked) {
            formdata = formdata + "&jrqp=1";
        } else {
            formdata = formdata + "&jrqp=0";
        }
    }
    var rest = new RegExp("&", "g");
    var rest2 = new RegExp("=", "g");
    formdata = formdata.replace(rest, "[—_-|]")
    formdata = formdata.replace(rest2, "[|-o-]")

    jq.ajax({
        type: 'post',
        url: "portal.php?mod=beifen&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&lx=cun&ajax=1", //拼接
        data: "data=" + formdata + "&age=" + age,
        error: function () {
            alert('存储出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            var lur = rs['jieguo'];

            if (rs['msm']) {
                var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='cg'></i>" + lur + "</div></div>");
                jQuery("body").find(".copy-tips").remove().end().append(copysuc);
                jQuery(".copy-tips").fadeOut(1000);
            } else {
                alert(lur);

            }
        }
    })

}

var sjid = 0;

//yuncungai
jQuery('#yunfg').click(function () {
    yuncungai();
});

function yuncungai() {


    if (jQuery('textarea').is('#html_img') || jQuery('input').is('#html_img')) {
        if (!tycheck2()) {
            return false;
        }
    } else {
        if (!tycheck()) {
            return false;
        }

    }

    var formdata = jQuery('#shetsps').serialize()

    if (jQuery('label').is('#jrqpx')) {
        if (jQuery("#jiaruqp").get(0).checked) {
            formdata = formdata + "&jrqp=1";
        } else {
            formdata = formdata + "&jrqp=0";
        }
    }
    var rest = new RegExp("&", "g");
    var rest2 = new RegExp("=", "g");
    formdata = formdata.replace(rest, "[—_-|]")
    formdata = formdata.replace(rest2, "[|-o-]")
    jq.ajax({
        type: 'post',
        url: "portal.php?mod=beifen&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&lx=gai&ajax=1", //拼接
        data: "data=" + formdata + "&sjid=" + sjid + "&age=" + toolsname,
        error: function () {
            alert('覆盖出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            var lur = rs['jieguo'];
            var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='cg'></i>" + lur + "</div></div>");
            jQuery("body").find(".copy-tips").remove().end().append(copysuc);
            jQuery(".copy-tips").fadeOut(1000);
        }
    })

}

//yuncundu
jQuery('#yundq').click(function () {
    yuncundu(sjid);
});

function yuncundu(sjids) {
    jQuery('.yundom').hide();
    var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>读取中，请稍后..</div></div>");
    jQuery("body").find(".copy-tips").remove().end().append(copysuc);
    sjid = sjids;
    jq.ajax({
        type: 'post',
        url: "portal.php?mod=beifen&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&lx=du&ajax=1", //拼接
        data: "sjid=" + sjids + "&data=[|-o-][—_-|]",
        error: function () {
            alert('读取出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            var lur = rs['jieguo'];
            yuncunfx(lur);
            if (typeof yzys == "undefined" || yzys==null) {
                jQuery(".bkan .fgbf").css("display", "block");
                jQuery(".bkan .lcsj a").html('当前操作记录另存为');
            }

        }
    })
    jQuery(".copy-tips").fadeOut(3000);
}


//yuncunfx

function yuncunfx(ydata) {
    var str = ydata;

  //  console.log("LoG：" + str);

    var strs = new Array(); //定义一数组 
    strs = str.split("[—_-|]"); //字符分割 
    var yfg = new Array();
    for (i = 0; i < strs.length; i++) {
        yfg = strs[i].split("[|-o-]");
        //店铺类型处理
        if (yfg[0] == 'dplx' && jQuery('input').is('.dplx3')) {
            //alert(jQuery('[name="dplx"]').eq(3).val());
            jQuery('label.dplxla').removeClass('checked');
            jQuery('input[name="dplx"]').removeAttr('checked');
            jQuery('#dplx label').eq(yfg[1]).attr('class', 'dplxla checked');
            jQuery('[name="dplx"]').eq(yfg[1]).attr('checked', 'checked');
        }

        if (yfg[0] == 'jrqp' && yfg[1] == 1 && jQuery('label').is('#jrqpx')) { //是否加入全屏
            jQuery('label#jrqpx').attr('class', 'jrqpdaim');
            jQuery('#jiaruqp').attr('checked', 'checked');
        } else if (jQuery('label').is('#jrqpx') && str != "null") {
            jQuery('label#jrqpx').attr('class', 'checked');
            jQuery('#jiaruqp').removeAttr('checked');
        }

        if (yfg[0] == 'donghua' || yfg[0] == 'opentype') {
            jQuery('[value="' + yfg[1] + '"]').attr('checked', 'checked');
        } else if (yfg[0] != 'dplx' && yfg[0] != 'jrqp' && jQuery('select').is('[name="' + yfg[0] + '"]') == false) {

            if (yfg[0].indexOf('wwnc') != -1 && jQuery('input,select,textarea').is('[name="' + yfg[0] + '"]') == false) {
                var lsnama = yfg[0];
                lsnama = lsnama.replace(/\[(.*?)\]/, '[1]');
                if (jQuery('[name="' + yfg[0] + '"]').length > 0) {
                    addpics();
                }


            } else if (jQuery('input,select,textarea').is('[name="' + yfg[0] + '"]') == false) {

                var lsnama = yfg[0];
                lsnama = lsnama.replace(/\[(.*?)\]/, '[1]');

                if (yfg[0].indexOf('dhm[') != -1 || yfg[0].indexOf('dhlj[') != -1) {
                    if (jQuery('[name="' + lsnama + '"]').length > 0) {
                        adddhli();
                    }
                } else if (yfg[0].indexOf('ryturl[') != -1 || yfg[0].indexOf('ryt[') != -1) {
                    if (jQuery('[name="' + lsnama + '"]').length > 0) {
                        addpicryt();
                    }
                } else {
                    if (jQuery('[name="' + lsnama + '"]').length > 0) {
                        addpic();
                    }
                }
            }

            // console.log(yfg[0]);
            if (jQuery('[name="' + yfg[0] + '"]').length > 0) {
                jQuery('[name="' + yfg[0] + '"]').val(htmlDecode(yfg[1]));
                
            }

        } else if (jQuery('select').is('[name="' + yfg[0] + '"]') != false) {
            //组合框读取 
            jQuery('[name="' + yfg[0] + '"]  option[value="' + yfg[1] + '"]').attr("selected", true);
        }
    }


    if (jQuery('.btn-ok').length > 0) {
        yunguiwei();
    }
    //xuansezujian();
}

//yuncundulist

jQuery('#yundqlist').click(function () {
    if (jQuery(".hovertable tr").length < 2) {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>云端数据读取中..</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
        yuncundulist();
    } else if (jQuery(".hovertable tr").length > 1) {
        jQuery('.yundom').show();
    }
});
jQuery('.bkan #select.sj_bf_btn').click(function () {
    if (jQuery(".hovertable tr").length < 2) {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='dd'></i>云端数据读取中..</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
        yuncundulist();
    } else if (jQuery(".hovertable tr").length > 1) {
        jQuery('.yundom').show();
    }
});
/*
jQuery('.bkandh #select.sj_bf_btn').click(function () {
    window.open("https://work.1688.com/");
});
*/
function yuncundulist() {
    jq.ajax({
        type: 'post',
        url: "portal.php?mod=beifen&formhash=" + jQuery("#yformhash").html() + "&lx=dulist&ajax=1", //拼接
        data: "aid=" + aid + "&data=[|-o-][—_-|]",
        error: function () {
            alert('读取出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            for (i = 0; i < rs.length - 1; i++) {
                var newpic = "<tr  class=\"tms" + i + "\" onmouseover=\"this.style.backgroundColor='#545454';\" onmouseout=\"this.style.backgroundColor='#7B7B7B';\">	<td class=\"xh\">" + (i + 1) + "</td><td  id=\"bfname\"><span>" + rs[i]['bftiele'] + "</span></td><td>" + getLocalTime(rs[i]['bfimes']) + "</td><td><button  name=\"tms" + i + "\" value=\"" + rs[i]['sjid'] + "\" class=\"bfdr\"  type=\"button\">导入备份</button></td><td><button  name=\"tms" + i + "\"  value=\"" + rs[i]['sjid'] + "\" class=\"bfdel\"  type=\"button\">删除备份</button></td></tr>";
                jQuery(".hovertable tbody").append(newpic);
                //
            }
            if (jQuery(".hovertable tr").length > 1) {
                jQuery('.yundom').show();
                jQuery(".yundom .nls").remove();

                jQuery('.hovertable .bfdr').click(function () {
                    yuncundu(jQuery(this).val());
                    toolsname = jQuery('.' + this.name + " span").html();
                });

                jQuery('.hovertable .bfdel').click(function () {
                    yuncundel(jQuery(this).val(), this.name);
                });
            } else {
                jQuery(".copy-tips").fadeOut(1000);
                var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='cw'></i>未发现操作备份..</div></div>");
                jQuery("body").find(".copy-tips").remove().end().append(copysuc);
                jQuery(".copy-tips").fadeOut(3000);

            }
        }
    })
    jQuery(".copy-tips").fadeOut(3000);
}

jQuery('.yundom .gb').click(function () {
    jQuery('.yundom').hide();
});

function yuncundel(sjids, name) {
    jq.ajax({
        type: 'post',
        url: "portal.php?mod=beifen&aid=" + aid + "&formhash=" + jQuery("#yformhash").html() + "&lx=del&ajax=1", //拼接
        data: "sjid=" + sjids + "&data=[|-o-][—_-|]",
        error: function () {
            alert('读取出错请检查您的设置');
        },
        success: function (html) {
            rs = eval("(" + html + ")");
            var lur = rs['jieguo'];
            jQuery(".yundom ." + name).remove();
            if (jQuery(".hovertable tr").length < 2) {
                jQuery('.yundom').hide();
            }
        }
    })
}




jQuery(function () {
    jQuery('label.dplxla').click(function () {
        var radioId = jQuery(this).attr('for');
        jQuery('label.dplxla').removeClass('checked') && jQuery(this).attr('class', 'dplxla checked');
        jQuery('input[name="dplx"]').removeAttr('checked') && jQuery('.dplx' + radioId).attr('checked', 'checked');
    });
});


jQuery('label#jrqpx').click(function () {
    if (jQuery("#jiaruqp").get(0).checked) {
        jQuery('label#jrqpx').attr('class', 'jrqpdaim');
    } else {
        jQuery('label#jrqpx').attr('class', 'checked');
    }
});


function fktimeshow() {
    var mydate = new Date();
    var str = "" + mydate.getFullYear() + "年";
    str += (mydate.getMonth() + 1) + "月";
    str += mydate.getDate() + "日";
    str += mydate.getHours() + "时";
    str += mydate.getMinutes() + "分";
    return str;
}



function getLocalTime(nS) {
    return new Date(parseInt(nS) * 1000).toLocaleString().replace(/:\d{1,2}$/, ' ');
}


jQuery(function () {

    jQuery("#rerun")
        .button()
        .click(function () {
            menu.hide();
        })
        .next()
        .button({
            text: false,
            icons: {
                primary: "ui-icon-triangle-1-s"
            }
        })
        .mouseover(function () {
            var menu = jQuery(this).parent().next().show().position({
                my: "left top",
                at: "left bottom",
                of: this
            });
            jQuery(document).one("click", function () {
                menu.hide();
            });
            return false;
        })
        .parent()
        .buttonset()
        .next()
        .hide()
        .menu();
});

jQuery(function () {

    jQuery("#kjdh")
        .button()
        .click(function () {
            menu.hide();
        })
        .next()
        .button({
            text: false,
            icons: {
                primary: "ui-icon-triangle-1-s"
            }
        })
        .mouseover(function () {
            var menu = jQuery(this).parent().next().show().position({
                my: "left top",
                at: "left bottom",
                of: this
            });
            jQuery(document).one("click", function () {
                menu.hide();
            });
            return false;
        })
        .parent()
        .buttonset()
        .next()
        .hide()
        .menu();
});

jQuery(function () {
    jQuery('#shetsps').tooltip({
        position: {
            my: "center bottom-20",
            at: "center top",
            using: function (position, feedback) {
                jQuery(this).css(position);
                jQuery("<div>")
                    .addClass("arrow")
                    .addClass(feedback.vertical)
                    .addClass(feedback.horizontal)
                    .appendTo(this);
            }
        }
    });
});



//zzzz

function tianjian(na) {
    if (na == 'wwzj') {
        addjww();
    } else if (na == 'requ') {
        addrq();
    }


    jQuery(function () {
        jQuery(".zpops").draggable()
    });
}

var nmww = 1;

function addjww() {
    nmww = nmww + 1;
    var newww = '<span class="zpops ww" name="alww" id="ww' + nmww + '" style="width: 77px; height: 19px;position: absolute;top: 12px; left: 499px; cursor: move;;background: url(http://wwimgsrc.cn-hangzhou.oss-pub.aliyun-inc.com/htdocs/im/actions/wbtx/alitalk/10/online.gif) no-repeat;" data-param="{&quot;wwid&quot;:&quot;' + tywwid + '&quot;,&quot;style&quot;:10,&quot;title&quot;:&quot;点击联系我&quot;}"></span>';
    jQuery('#dmspmk').append(newww);
    getObjdata(jQuery("#ww" + nmww));
    jQuery("#dialog-con").dialog("open");
    jQuery("#dialog-requ").dialog("close");
}

var nmrq = 0;

function addrq() {
    nmrq = nmrq + 1;
    var newrq = '<span  class="zpops rq rez"  name="requ"  id="rq' + nmrq + '" style="width:165px; height:75px;position: absolute;top: 12px; left: 499px; cursor: move;opacity: 0.5;background: rgb(0, 230, 255);" data-param="{&quot;aurl&quot;:&quot;&quot;,&quot;style&quot;:&quot;_blank&quot;}"></span>';
    jQuery('#dmspmk').append(newrq);
    jQuery("#dmspmk .rez").resizable();
    getObjdata(jQuery("#rq" + nmrq));
    jQuery("#dialog-con").dialog("close");
    jQuery("#dialog-requ").dialog("open");

}

jQuery('.popzjmb li').live({
    click: function () {
        tianjian(this.id);
    }
});



jQuery('.zpops').live({
    dblclick: function () { //双击	
        dcike(this);
    },
    mousedown: function () { //单击	
        dcike(this);
    },
    mouseenter: function () { //鼠标经过
        jQuery(this).append("<div class='plst'><div class='aniu delniu' title='删除此组件'>×</div></div>");
    },
    mouseleave: function () { //鼠标移开
        jQuery('.plst').remove();
    }
});

function dcike(zjcko) {
    var manes = jQuery(zjcko).attr("name");
    if (manes == "alww") {
        jQuery("#dialog-con").dialog("open");
        jQuery("#dialog-requ").dialog("close");
        getObjdata(jQuery(zjcko));

    } else if (manes == "requ") {
        jQuery("#dialog-requ").dialog("open");
        jQuery("#dialog-con").dialog("close");
        getObjdata(jQuery(zjcko));

    }


}

jQuery('.delniu').live({
    click: function () {
        zjd = jQuery(this).parent().parent();

        zjd.remove();
        jQuery('#shuxin').fadeOut();
        jQuery("#dialog-con").dialog("close");
        jQuery("#dialog-requ").dialog("close");
    }
});

jQuery('.addniu').live({
    click: function () {
        zjd = jQuery(this).parent().parent();

        var newboj = jQuery(zjd).prop("outerHTML");

        jQuery('#dmspmk').append(jQuery(newboj).clone(true))

        alert(newboj);

    }
});


function getObjdata(bjzu) {
    var jsdata = bjzu.attr('data-param');
    if (typeof jsdata != 'undefined') {
        JSONdata = jQuery.parseJSON(jsdata);
        jQuery("#wwid").val(JSONdata['wwid']);
        jQuery('input[name="style"][value="' + JSONdata['style'] + '"]').attr('checked', 'checked');
        jQuery("#title").val(JSONdata['title']);
        jQuery("#zjid").html(bjzu.attr('id'));

        jQuery("#rqurl").val(JSONdata['aurl']);
    }
}

//绑定事件
jQuery(document).ready(function () {
    /* jQuery(".input-box").change(function(){
    baosww();
    }); */

    jQuery('.input-box').bind('input propertychange', function () {
        if (this.id == "mkbg") {
            psize(this, 1);
        } else {
            baosww();
        }

    });

    jQuery('input[type=radio][name=style]').change(function () {
        baosww();
    });

    jQuery('#suodin').click(function () {
        if (jQuery("#suodin").get(0).checked) {
            jQuery('#dmspmk').css({
                "background-attachment": "fixed"
            });
        } else {
            jQuery('#dmspmk').css({
                "background-attachment": "inherit"
            });
        }
    });

    jQuery('#pinpu').click(function () {
        if (jQuery("#pinpu").get(0).checked) {
            jQuery('#dmspmk').css({
                "background-repeat": "repeat"
            });
        } else {
            jQuery('#dmspmk').css({
                "background-repeat": "no-repeat"
            });
        }
    });

    jQuery('#juzhon').click(function () {
        if (jQuery("#juzhon").get(0).checked) {
            jQuery('#dmspmk').css({
                "background-position": "center center"
            });
        } else {
            jQuery('#dmspmk').css({
                "background-position": "left top"
            });
        }
    });

    jQuery('#mkwyc').click(function () {
        if (jQuery("#mkwyc").get(0).checked) {
            jQuery('#dmspmk').css({
                "overflow": "hidden"
            });
        } else {
            jQuery('#dmspmk').css({
                "overflow": "visible"
            });
        }
    });


    jQuery('#texssczydm').click(function () {
        sczydm(1);
    });

    jQuery('#texsylzydm').click(function () {
        sczydm(0);
    });

});


function GetmkCode() {
    var qp = 0;
    if (jQuery("#jiaruqps").get(0).checked) {
        qp = 1;
    } else {
        qp = 0;
    }

    var main = {
        zjName: 'main',
        style: jQuery('#dmspmk').attr('style'),
        width: jQuery('#dmspmk').width(),
        height: jQuery('#dmspmk').height(),
        xs: jQuery('#xiaoshang').val(),
        xx: jQuery('#xiaoxia').val(),
        jrqp: qp
    };
    var lsss = [];
    var jsss = [];
    var zzs = jQuery('#dmspmk').children('span').length;

    for (var i = 0; i < zzs; i++) {
        lsss[i] = {
            zjName: jQuery('#dmspmk span').eq(i).attr('name'),
            //style: jQuery('#dmspmk span').eq(i).attr('style'),
            top: jQuery('#dmspmk span').eq(i).css('top'),
            left: jQuery('#dmspmk span').eq(i).css('left'),
            backgroundimg: jQuery('#dmspmk span').eq(i).css('background-image'),
            backgroundrep: jQuery('#dmspmk span').eq(i).css('background-repeat'),
            backgroundzz: jQuery('#dmspmk span').eq(i).css('background-position'),
            backgroundcl: jQuery('#dmspmk span').eq(i).css('background-color'),
            width: jQuery('#dmspmk span').eq(i).width(),
            height: jQuery('#dmspmk span').eq(i).height(),
            jonssj: jQuery('#dmspmk span').eq(i).attr('data-param')
        };

    }

    var st = {
        main: main,
        data: lsss,
    };

    return st;
}

function baosww() {
    tywwid = jQuery("#wwid").val();

    var wwstyle = jQuery('input:radio[name="style"]:checked').val();
    jQuery('#' + jQuery("#zjid").html()).attr('data-param', '{"wwid":"' + jQuery("#wwid").val() + '","style":"' + wwstyle + '","title":"' + jQuery("#title").val() + '","aurl":"' + jQuery("#rqurl").val() + '"}');

    if (wwstyle == 10) {
        jQuery('#' + jQuery("#zjid").html()).css({
            "background": 'url("https://wwimgsrc.cn-hangzhou.oss-pub.aliyun-inc.com/htdocs/im/actions/wbtx/alitalk/10/online.gif") no-repeat 0px 0px',
            "width": '77',
            "height": '19'
        });
    } else if (wwstyle == 11) {
        jQuery('#' + jQuery("#zjid").html()).css({
            "background": 'url("https://wwimgsrc.cn-hangzhou.oss-pub.aliyun-inc.com/htdocs/im/actions/wbtx/alitalk/11/online.gif") no-repeat 0px 0px',
            "width": "22",
            "height": "22"
        });
    } else if (wwstyle == 12) {
        jQuery('#' + jQuery("#zjid").html()).css({
            "background": 'url("https://wwimgsrc.cn-hangzhou.oss-pub.aliyun-inc.com/htdocs/im/actions/wbtx/alitalk/12/online.gif") no-repeat -14px 0px',
            "width": "30",
            "height": "30"
        });
    } else if (wwstyle == 1) {
        jQuery('#' + jQuery("#zjid").html()).css({
            "background": 'url("https://wwimgsrc.cn-hangzhou.oss-pub.aliyun-inc.com/htdocs/im/actions/wbtx/alitalk/1/online.gif") no-repeat 0px 0px',
            "width": '77',
            "height": '19'
        });
    }
}

//属性面板
jQuery(function () {
    jQuery("#dialog-zjmb").draggable()
});

var tywwid = "";
var cisk = (window.innerWidth - 275);

jQuery(function () {
    jQuery("#dialog-qjsz").dialog({
        autoOpen: true,
        width: 255,
        position: [cisk, 90],
        resizable: false,
        dialogClass: 'sxmb',
        //modal: true,

        show: {
            effect: "blind",
            duration: 1000
        },
        hide: {
            effect: "explode",
            duration: 1000
        },
        open: function (event, ui) {
            jQuery(".ui-dialog-titlebar-close", jQuery(this).parent()).hide();
        }
    });

});

jQuery(function () {
    jQuery("#dialog-con").dialog({
        autoOpen: false,
        width: 255,
        position: [cisk, jQuery('[aria-describedby="dialog-qjsz"]').outerHeight() + 92],
        resizable: false,
        dialogClass: 'sxmb',
        //modal: true,

        show: {
            effect: "blind",
            duration: 1000
        },
        hide: {
            effect: "explode",
            duration: 1000
        }
    });

});

jQuery(function () {
    jQuery("#dialog-requ").dialog({
        autoOpen: false,
        width: 255,
        position: [cisk, jQuery('[aria-describedby="dialog-qjsz"]').outerHeight() + 92],
        resizable: false,
        dialogClass: 'sxmb',
        //modal: true,

        show: {
            effect: "blind",
            duration: 1000
        },
        hide: {
            effect: "explode",
            duration: 1000
        }
    });

});

jQuery(function () {
    jQuery("#zyscdm").dialog({
        autoOpen: false,
        width: 800,
        height: 420,
        // resizable: false,
        dialogClass: 'dmcope',
        modal: true,

        show: {
            effect: "blind",
            duration: 1000
        },
        hide: {
            effect: "explode",
            duration: 1000
        }
    });

});

jQuery(window).resize(function () {
    cisk = (window.innerWidth - 275);
    jQuery('.sxmb').css({
        'left': cisk + 'px'
    });
    jQuery('#cdmkssss').css({
        "height": window.innerHeight - 5
    });
});







function yulandaimazy(reszi) {
    var neyyss = jQuery('#code').val();
    if (neyyss.indexOf("&amp;gt;") < 1 && neyyss.indexOf("&gt;") < 0 && neyyss.indexOf(">") < 0) {
        return false;
    }

    if (jQuery('#code').val() == "") {
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'>请先生成代码再预览效果！</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
        jQuery(".copy-tips").fadeOut(3000);
        return false
    }
    var postdta = "";
    if (reszi != "") {
        postdta = reszi;
    } else {
        postdta = jQuery('#code').val();
    }

    jq.post("/static/yulandaima/yulan.php", {
        leix: 4,
        data: htmlDecode(postdta),
    },
        function (data, status) {
            var yldm = htmlDecode(data);
            var rest2 = new RegExp("alquot", "g");
            yldm = yldm.replace(rest2, "&quot;");

            var copysuc = jQuery("<div class='copy-yltips'><div class='copy-yltips-wrap'><input type='button' value='预览窗口打开失败,请点击此按钮预览效果！' name='sddkyl' id='sddkyl' class='btn-ok'><a href='http://www.mgzxzs.com/tmtbzxjc/644.html' class='szblj'  target='_blank'>设置预览窗口不被拦截的方法</a></div></div>");
            jQuery("body").find(".copy-yltips").remove().end().append(copysuc);

            jQuery('.copy-yltips #sddkyl').click(function () {
                mytools.webdebugger.Webtest(yldm);
                jQuery(".copy-yltips").fadeOut(2);
            });
            jQuery('.copy-yltips a').click(function () {
                jQuery(".copy-yltips").fadeOut(2);
            });

            mytools.webdebugger.Webtest(yldm);
            jQuery(".copy-yltips").fadeOut(2);

        });
};




function hfhtmk(obj) {
    jQuery(obj).val(zhuanyiut8(jQuery(obj).val()));
}


function zhuanyiut8(atata) {
    var jieguo = htmlDecode(atata);

    jieguo = jieguo.replace(/\\u0020/g, "");
    jieguo = jieguo.replace(/stylE/g, "style");
    jieguo = jieguo.replace(/&amp;/g, "&");
    jieguo = jieguo.replace(/&amp;/g, "&");
    jieguo = jieguo.replace(/&amp;#60;/g, '<');
    jieguo = jieguo.replace(/&amp;#62;/g, '>');
    jieguo = jieguo.replace(/&amp;#61;/g, '=');
    jieguo = jieguo.replace(/&amp;#99;&amp;#108;&amp;#97;&amp;#115;&amp;#115;/g, 'class');
    jieguo = jieguo.replace(/&amp;#115;&amp;#116;&amp;#121;&amp;#108;&amp;#101;/g, 'style');
    jieguo = jieguo.replace(/&amp;#115;&amp;#116;&amp;#121;&amp;#108;&amp;#69;/g, 'stylE');
    jieguo = jieguo.replace(/&amp;#60;/g, '<');
    jieguo = jieguo.replace(/&amp;#62;/g, '>');
    jieguo = jieguo.replace(/&amp;quot;/g, '"');
    jieguo = jieguo.replace(/<pre/g, '<div');
    jieguo = jieguo.replace(/textarea/g, 'div');
    jieguo = jieguo.replace(/white-space: inherit;/g, '');
    jieguo = jieguo.replace(/white-space:inherit;/g, '');
    jieguo = jieguo.replace(/&quot;/g, '"');
    jieguo = jieguo.replace(/&#60;/g, '<');
    jieguo = jieguo.replace(/&#62;/g, '>');
    jieguo = jieguo.replace(/&#61;/g, '=');
    jieguo = jieguo.replace(/&#99;&#108;&#97;&#115;&#115;/g, 'class');
    jieguo = jieguo.replace(/&#115;&#116;&#121;&#108;&#101;/g, 'style');
    jieguo = jieguo.replace(/&#115;&#116;&#121;&#108;&#69;/g, 'stylE');
    jieguo = jieguo.replace(/&#60;/g, '<');
    jieguo = jieguo.replace(/&#62;/g, '>');
    jieguo = htmlDecode(jieguo);
    return jieguo;
}

function dmkhtml(obj, lx) {
    var jiegma = zhuanyiut8(jQuery(obj).val());
    jQuery(obj).val(jiegma);
    if (lx == 1) {
        var zhanshima = jiegma.replace(/href/g, 'd-href');
        zhanshima = zhanshima.replace(/target/g, 'd-target');
        jQuery('#datu1 .htmlmkSmk').html(zhanshima);

    }
}






function ziyfx(ydata) {
    var daaa = ydata;
    var ydatas = daaa.replace(/\[\—\_\-\|\]/g, '"');
    ydatas = ydatas.replace(/\[\|\-\o\-\]/g, "=");
    ydatas = ydatas.replace(/\"\=/, "");
    var rest2 = new RegExp("&quot;", "g");
    ydatas = ydatas.replace(rest2, '"');

    /* var rest2 = new RegExp("&quot;","g");	
    ydatas = ydatas.replace(rest2,'"');	
    rs=eval("("+ydatas+")");	 */

    //alert(rs['data'][1]["zjName"]);
    ydatas = htmlDecode(ydatas);
    ydatas = ydatas.replace(/\"quot\;/g, "&quot;");

    ydatas = ydatas.replace(/ui-resizable/g, "");
    ydatas = ydatas.replace(/ui-icon-gripsmall-diagonal-se/g, "");
    ydatas = ydatas.replace(/ui-resizable-handle/g, "");
    ydatas = ydatas.replace(/ui-resizable-se/g, "");
    ydatas = ydatas.replace(/ui-draggable/g, "");
    ydatas = ydatas.replace(/ui-resizable-s/g, "");
    ydatas = ydatas.replace(/ui-icon/g, "");
    jQuery('#dmspmk').remove();

    jQuery('.democao').append(ydatas);

    jQuery(function () {
        jQuery(".zpops").draggable();
    });

    jQuery("#dmspmk .rez").resizable();
}


function fuzhishijian() {
    //代码复制事件
    var clipboard = new ClipboardJS('.copydm,#copyCode');
    clipboard.on('success', function (e) {
        if (e.text == "") {
            var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='cw'></i>请先生成代码再复制代码！</div></div>");
            jQuery("body").find(".copy-tips").remove().end().append(copysuc);
            jQuery(".copy-tips").fadeOut(3000);
        } else {
            var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='cg'></i>复制成功</div></div>");
            jQuery("body").find(".copy-tips").remove().end().append(copysuc);
            jQuery(".copy-tips").fadeOut(3000);
        }
    });
    clipboard.on('error', function (e) {
        jQuery('.fuzhi').hide();
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='gt'></i>复制失败，请在以下编辑框中手动复制代码。</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
        jQuery(".copy-tips").fadeOut(3000);
        //JS选中文本框中内容
        document.getElementById("scdm_html").focus();
        document.getElementById("scdm_html").select();
        //jquery选中文本框中内容
        jQuery("#scdm_html").focus();
        jQuery("#scdm_html").select();
    });

    //复制可插入到DW代码事件
    var clipboarddw = new ClipboardJS('.fzkcrdm', {
        text: function () {
            var ybyt = htmlDecode(jQuery('#scdm_html').val());
            ybyt = htmlDecode(ybyt);
            ybyt = ybyt.replace(/\\u0020/g, "");
            ybyt = ybyt.replace(/stylE/g, "style");
            ybyt = ybyt.replace(/&amp;/g, "&");
            return zhuanyiut8(ybyt);
        }
    });

    clipboarddw.on('success', function (e) {
        if (e.text == "") {
            var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='cw'></i>请先生成代码再复制代码！</div></div>");
            jQuery("body").find(".copy-tips").remove().end().append(copysuc);
            jQuery(".copy-tips").fadeOut(3000);
        } else {
            var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='cg'></i>复制成功</div></div>");
            jQuery("body").find(".copy-tips").remove().end().append(copysuc);
            jQuery(".copy-tips").fadeOut(3000);
        }
    });

    clipboarddw.on('error', function (e) {
        jQuery('.fuzhi').hide();
        var copysuc = jQuery("<div class='copy-tips'><div class='copy-tips-wrap'><i class='gt'></i>复制失败，请在以下编辑框中手动复制代码。</div></div>");
        jQuery("body").find(".copy-tips").remove().end().append(copysuc);
        jQuery(".copy-tips").fadeOut(3000);
        //JS选中文本框中内容
        document.getElementById("scdm_html").focus();
        document.getElementById("scdm_html").select();
        //jquery选中文本框中内容
        jQuery("#scdm_html").focus();
        jQuery("#scdm_html").select();
    });
    //复制事件结束
} fuzhishijian();

//取随机范围数字
function randomFrom(lowerValue, upperValue) {
    return Math.floor(Math.random() * (upperValue - lowerValue + 1) + lowerValue);
}

//颜色选择器
function xuansezujian() {
    jQuery('.yanse').each(function () {
        jQuery(this).minicolors({
            control: jQuery(this).attr('data-control') || 'hue',
            defaultValue: jQuery(this).attr('data-defaultValue') || '',
            inline: jQuery(this).attr('data-inline') === 'true',
            letterCase: jQuery(this).attr('data-letterCase') || 'lowercase',
            opacity: jQuery(this).attr('data-opacity'),
            position: jQuery(this).attr('data-position') || 'bottom left',
            change: function (hex, opacity) {
                var log;
                try {
                    log = hex ? hex : 'transparent';
                    if (opacity) log += ', ' + opacity;
                    console.log(log);
                } catch (e) { }
            },
            theme: 'default'
        });
    });
}

//指定组件颜色选择器
//xuansezujianobj('[name="wzs[' + pic + ']"]');	
function xuansezujianobj(objs) {
    jQuery(objs).each(function () {
        jQuery(objs).minicolors({
            control: jQuery(objs).attr('data-control') || 'hue',
            defaultValue: jQuery(objs).attr('data-defaultValue') || '',
            inline: jQuery(objs).attr('data-inline') === 'true',
            letterCase: jQuery(objs).attr('data-letterCase') || 'lowercase',
            opacity: jQuery(objs).attr('data-opacity'),
            position: jQuery(objs).attr('data-position') || 'bottom left',
            change: function (hex, opacity) {
                var log;
                try {
                    log = hex ? hex : 'transparent';
                    if (opacity) log += ', ' + opacity;
                    console.log(log);
                } catch (e) { }
            },
            theme: 'default'
        });
    });
}

//操作台换一张按钮 配合操作台 getsuijiobj(url) 使用
jQuery('#hbg').click(function () {
    jQuery.ajax({
        type: "GET",
        url: "/static/suijiobj.php?typ=imgbg",
        data: "",
        dataType: "text",
        success: function (response) {
            getsuijiobj(response);
        }
    });
});
function GetUrlParam(paraName) {
    var url = document.location.toString();
    var arrObj = url.split("?");

    if (arrObj.length > 1) {
        var arrPara = arrObj[1].split("&");
        var arr;

        for (var i = 0; i < arrPara.length; i++) {
            arr = arrPara[i].split("=");

            if (arr != null && arr[0] == paraName) {
                return arr[1];
            }
        }
        return "";
    }
    else {
        return "";
    }
}
function mobanhuitiao(nrdams) {
    var mycars = new Array();
    mycars[0] = 'chuacan';
    mycars[1] = GetUrlParam('mdid') == "" ? GetUrlParam('topmdid') : GetUrlParam('mdid');
    mycars[2] = nrdams;

    var formdata = jQuery('#shetsps').serialize();
    if (jQuery('label').is('#jrqpx')) {
        if (jQuery("#jiaruqp").get(0).checked) {
            formdata = formdata + "&jrqp=1";
        } else {
            formdata = formdata + "&jrqp=0";
        }
    }
    var rest = new RegExp("&", "g");
    var rest2 = new RegExp("=", "g");
    formdata = formdata.replace(rest, "[—_-|]");
    formdata = formdata.replace(rest2, "[|-o-]");
    mycars[3] = formdata;
    mycars[3] = decodeURIComponent(mycars[3]);
    mycars[3] = mycars[3].replace(/\n/g, '%0a');
    mycars[4] = GetUrlParam('mdid') == "" ? "add" : 'set';

    mycars[5] = aid;

    window.parent.postMessage(mycars, '*');
}



//接受父页面参数 
window.addEventListener('message', function (event) {
    this.console.log("记录");
    this.console.log(event);
    var getdyay = event.data;
    if (getdyay.length > 1) {
        if (getdyay[0] == "czjl") {
            if (getdyay[1] != "") {
                var zhuanh = decodeURIComponent(getdyay[1]);
                yuncunfx(zhuanh);
            }
        } else {

        }
    }
});



//重点处理搜索框功能,导出代码问题
function ljzhas() {
    jQuery(document).on("change", "#daohanglis .input-box,.textarea-box,.control-group .input-box", function () {
        var _this = this;
        if (this.name.indexOf('dhlj') != -1 || this.name.indexOf('xiala') != -1 || this.name.indexOf('url') != -1) {

            var yuanlian = jQuery(_this).val();
            if (yuanlian.indexOf("&catName=") != -1) {
                yuanlian = yuanlian.replace(/&catName=[^\s]*/g, "");
                jQuery(_this).val(yuanlian);
            }
            if (yuanlian.indexOf("&keyword=") != -1) {
                yuanlian = yuanlian.replace(/&keyword=[^\s]*/g, "");
                jQuery(_this).val(yuanlian);
            }


            if (yuanlian.indexOf("?q=") != -1 || yuanlian.indexOf("?q=") != -1) {
                alert("不支持加入搜索页面链接！请跟换其他链接使用哦");
            }
        }
    });
} ljzhas();